# Orchestrator MCP Client Configuration
#
# Configuration Priority (lowest to highest):
# 1. config.toml file (base defaults)
# 2. .env file (environment-specific config)
# 3. System environment variables (runtime secrets)
#
# All orchestrator-specific values can be overridden by environment variables with ORCHESTRATOR_ prefix
# Example: ORCHESTRATOR_NATS__URL=nats://production:4222
#
# LLM configuration can be overridden with LLM_* prefix:
# - LLM_TYPE=google
# - LLM_URL=https://generativelanguage.googleapis.com/v1
# - LLM_GOOGLE_API_KEY=your-api-key
# - LLM_MODELS_EN=gemini-1.5-flash

[service]
name = "orchestrator"
version = "0.1.0"
description = "TaleTrail Orchestrator - Coordinates multi-phase pipeline with negotiation protocol"

[nats]
url = "nats://localhost:5222"
subject = "mcp.orchestrator.request"
queue_group = "orchestrator"

[nats.auth]
# NKey authentication (replaces mTLS client certificates)
nkey_file = "../nkeys/orchestrator.nk"

[nats.tls]
# TLS for encryption (no client cert needed with NKey auth)
ca_cert = "../certs/ca.pem"

[llm]
type = "lmstudio"
url = "http://127.0.0.1:1234/v1"
default_model = "local-model"
use_default_model_fallback = true
max_tokens = 4096
temperature = 0.7
timeout_secs = 60
system_prompt_style = "native"

[llm.models]
en = "local-model"

[pipeline]
generation_timeout_secs = 120
validation_timeout_secs = 45
retry_max_attempts = 3
retry_base_delay_secs = 1
retry_max_delay_secs = 30

[batch]
size_min = 4
size_max = 6
concurrent_batches = 3
concurrent_batches_max = 5

[dag]
default_node_count = 16
convergence_point_ratio = 0.25
max_depth = 10

[negotiation]
max_rounds = 3

[retry]
max_attempts = 3
initial_delay_ms = 100
max_delay_ms = 5000
backoff_multiplier = 2.0
