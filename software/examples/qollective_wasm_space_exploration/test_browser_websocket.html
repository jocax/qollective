<!DOCTYPE html>
<html>
<head>
    <title>WebSocket Path Test</title>
</head>
<body>
    <h1>WebSocket Path Testing</h1>
    <div id="output"></div>
    <button onclick="testTelemetryEndpoint()">Test Telemetry Endpoint</button>
    <button onclick="testMissionEndpoint()">Test Mission Endpoint</button>
    <button onclick="testMCPEndpoint()">Test MCP Endpoint</button>

    <script>
        function log(message) {
            const output = document.getElementById('output');
            output.innerHTML += message + '<br>';
            console.log(message);
        }

        function testTelemetryEndpoint() {
            log('üîå Testing telemetry/subscribe endpoint...');
            
            const ws = new WebSocket('ws://127.0.0.1:8444/telemetry/subscribe');
            
            ws.onopen = function() {
                log('‚úÖ Connected to telemetry/subscribe endpoint');
                
                const request = {
                    type: "envelope",
                    data: {
                        spacecraft_id: "ORION-CM",
                        update_interval_ms: 1000
                    }
                };
                
                log('üì§ Sending telemetry subscription request...');
                ws.send(JSON.stringify(request));
            };
            
            ws.onmessage = function(event) {
                log('üì® Telemetry response: ' + event.data);
                ws.close();
            };
            
            ws.onerror = function(error) {
                log('‚ùå Telemetry WebSocket error: ' + error);
            };
            
            ws.onclose = function() {
                log('üîå Telemetry connection closed');
            };
        }

        function testMissionEndpoint() {
            log('üåü Testing mission/status endpoint...');
            
            const ws = new WebSocket('ws://127.0.0.1:8444/mission/status');
            
            ws.onopen = function() {
                log('‚úÖ Connected to mission/status endpoint');
                
                const request = {
                    type: "envelope",
                    data: {
                        mission_id: null
                    }
                };
                
                log('üì§ Sending mission status request...');
                ws.send(JSON.stringify(request));
            };
            
            ws.onmessage = function(event) {
                log('üì® Mission status response: ' + event.data);
                ws.close();
            };
            
            ws.onerror = function(error) {
                log('‚ùå Mission WebSocket error: ' + error);
            };
            
            ws.onclose = function() {
                log('üîå Mission connection closed');
            };
        }

        function testMCPEndpoint() {
            log('üõ†Ô∏è Testing MCP endpoint...');
            
            const ws = new WebSocket('ws://127.0.0.1:8445/mcp');
            
            ws.onopen = function() {
                log('‚úÖ Connected to MCP endpoint');
                
                const request = {
                    type: "envelope",
                    data: {
                        jsonrpc: "2.0",
                        id: 1,
                        method: "tools/call",
                        params: {
                            name: "rover_drill",
                            arguments: {
                                rover_id: "test_rover",
                                depth: 1.5
                            }
                        }
                    }
                };
                
                log('üì§ Sending MCP request...');
                ws.send(JSON.stringify(request));
            };
            
            ws.onmessage = function(event) {
                log('üì® MCP response: ' + event.data);
                ws.close();
            };
            
            ws.onerror = function(error) {
                log('‚ùå MCP WebSocket error: ' + error);
            };
            
            ws.onclose = function() {
                log('üîå MCP connection closed');
            };
        }
    </script>
</body>
</html>